////
Included in:

- user-manual: tables: Data formats
////

=== Escaping the Cell Separator

The parser scans for the cell separator to divide the cells _before_ it processes the cell text (no matter what that text contains, even passthroughs).
If your content includes the cell separator, you must escape that character using a leading backslash.
Otherwise, it will be interpreted as a cell separator.
The backslash will be removed from the converted output.

Consider the following example:

[source,asciidoc]
----
[cols=2*]
|====
|The default separator in PSV tables is the \| character.
|The \| character is often referred to as a "`pipe`".
|====
----

This table will render as follows:

.Result: Converted PSV table that contains pipe characters
[cols=2*]
|====
|The default separator in PSV tables is the \| character.
|The \| character is often referred to as a "`pipe`".
|====

Notice that the pipe character appears unescaped in the rendered result.

Escaping the cell separator character can be tedious.
There are also times when you can't or don't want to modify the content in the table cell.
To handle those cases, AsciiDoc allows you to override the cell separator.
The cell separator is controlled using the separator attribute on the table block.
You'll want to select a character that will never be used for content.
A good candidate is the broken bar, or `¦`.

Here's the previous example rewritten using a custom separator.

[source,asciidoc]
----
[cols=2*,separator=¦]
|====
¦The default separator in PSV tables is the | character.
¦The | character is often referred to as a "`pipe`".
|====
----

Notice that it's no longer necessary to escape the pipe character in the content of the table cells.

[[data-formats]]
=== Delimiter Separated Values

Tables can also be created from data stored as delimiter separated values (see link:https://en.wikipedia.org/wiki/Delimiter-separated_values[]).

In delimited data, each line in the file defines a row, and the cell values in each line are _separated_ by the delimiter (not _prefixed_ as in psv).

For example, to read Comma Separated Values (CSV) set the value of the `format` attribute on the table to `csv`:

[source]
----
include::ex-table-data.adoc[tags=csv]
----

.Result: Rendered CSV table
[width="90"]
include::ex-table-data.adoc[tags=csv]

This sort of data is often inserted into the table using the <<user-manual#include-directive,include directive>>.

[source]
----
[format="csv", options="header"]
|===
\include::tracks.csv[]
|===
----

////
.Result: Rendered table of CSV data pulled from a separate file
[width="90"]
[format="csv", options="header"]
|===
include::tracks.csv[]
|===
////

==== Cell Formating

The delimited format does not support formatting of individual cells.
However, you can apply formatting, such as the AsciiDoc style, to a column of cells using a table-wide column spec:

[source]
----
[format=csv,cols="1h,1a"]
|===
Sky,image::sky.jpg[]
Forest,image::forest.jpg[]
|===
----

==== Variants

CSV, TSV and DSV are variations on the theme of delimited data.
There are slight differences in the processing rules for each variant, as shown in the table below.

.Differences between DSV variants

[cols="<20a,<10a,<60a,<20a", options="header"]
|===

|Variant
|Value of the format attribute
|Rules
|Default delimiter

|Delimiter Separated Values

|`dsv`

|
* Blank lines are ignored.

* Spaces around the values are stripped.

* If rows do not have the same number of cells ("ragged" tables), cells are shuffled to fully fill the rows.

|colon (:)

|Comma Separated Values

|`csv`

|
* Blank lines are ignored.

* Spaces around the values are stripped.

* If rows do not have the same number of cells ("ragged" tables), cells are shuffled to fully fill the rows.
(This is different behaviour from Excel for example, where short rows are padded with empty cells).

* Values can be quoted using double quotes so that they can include the separator character.

* Double quotes can be embedded in the quoted values as a pair of double quotes `""`.

* Embedded newlines are allowed in the quoted string.
(They should be retained, but due to bug {uri-org}/asciidoctor/issues/2041[#2041] they are currently converted to a single space.)

|comma (,)

|Tab Separated Values

|`tsv`

|Same as csv

|tab character

|===

==== Delimiter Characters

Although each variant has a default separator associated with it, the separator can be changed to any character, or even a string, by setting the `separator` attribute on the table.

.The separator as a string
[source]
----
[format=dsv,separator=***]
|===
a***b***c
d***e***f
|===
----

NOTE: The separator is completely independant of the processing rules.
If you set `format=dsv` and `separator=,`, the data will be processed using the dsv rules, even though the data looks like CSV.

The tab character can be written as `format=\t` for convenience.

==== Shorthand

Asciidoctor provides some shorthand for common cases:

Using `,===` as the table block delimiter is the same as `format=csv`.

[source]
----
include::ex-table-data.adoc[tags=s-csv]
----

.Result: Rendered CSV table using shorthand syntax
[width="90"]
include::ex-table-data.adoc[tags=s-csv]

Using `:===` as the table block delimiter is the same as `format=dsv`.

[source]
----
include::ex-table-data.adoc[tags=s-dsv]
----

.Result: Rendered DSV table using shorthand syntax
[width="90"]
include::ex-table-data.adoc[tags=s-dsv]

When using either shorthand, do not set the `format` attribute as well.


